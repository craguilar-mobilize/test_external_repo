CREATE OR REPLACE SEQUENCE PUBLIC.DemoUsers_ID
  START WITH 1
COMMENT = 'FOR TABLE-COLUMN PUBLIC.DemoUsers.ID';

CREATE OR REPLACE TABLE PUBLIC.DemoUsers (
  ID        INTEGER DEFAULT PUBLIC.DemoUsers_ID.NEXTVAL /*** MSC-WARNING - MSCEWI1048 - SEQUENCE -  GENERATED BY DEFAULT  START WITH 1 ***/
  PRIMARY   KEY,
  Name      VARCHAR,
  Birthday  VARCHAR,
  CityCode  INTEGER,
  Email     VARCHAR
);

-- <sc-insert> </sc-insert> 
INSERT INTO PUBLIC.DemoUsers(Name, Birthday, CityCode, Email) VALUES('Emma Ezquivel', '2021-11-11', 123, 'emma@mobilize.se');

-- <sc-insert> </sc-insert> 
INSERT INTO PUBLIC.DemoUsers(Name, Birthday, CityCode, Email) VALUES('Daniel Duran', '2021-10-11', 456, 'daniel@mobilize.se');

-- <sc-insert> </sc-insert> 
INSERT INTO PUBLIC.DemoUsers(Name, Birthday, CityCode, Email) VALUES('Jennifer Jones', '2021-09-10', 789, 'jennifer@mobilize.se');

-- <sc-insert> </sc-insert> 
INSERT INTO PUBLIC.DemoUsers(Name, Birthday, CityCode, Email) VALUES('Joseph Jar', '2021-08-09', 741, 'joseph@mobilize.se');

-- <sc-view> DemoUserView </sc-view> 
CREATE OR REPLACE VIEW PUBLIC.View_DemoUsers (
  Name,
  CityCode,
  Email
)
AS
SELECT Name, CityCode, Email
FROM
  PUBLIC.DemoUsers;

-- <sc-procedure> InsertDemoUsers </sc-procedure> 
CREATE OR REPLACE PROCEDURE PUBLIC.InsertDemoUsers (in_Name VARCHAR, in_Birthday DATE, in_CityCode INTEGER, in_Email VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS
$$
  BEGIN
    INSERT INTO PUBLIC.DemoUsers(Name, Birthday, CityCode, Email)
    VALUES (:in_Name, :in_Birthday, n_CityCode, :in_Email);
-- ** MSC-ERROR - MSCEWI3111 - COMMIT STATEMENT REQUIRES ADDITIONAL INTERVENTION **
--    COMMIT
          ;
  END;
$$;

CALL PUBLIC.InsertDemoUsers('TestTable', '2020-12-12', 420, 'testTable@email.com');

-- <sc-procedure> UpdateDemoUsers </sc-procedure> 
CREATE OR REPLACE PROCEDURE PUBLIC.UpdateDemoUsers (in_id INTEGER, in_Name VARCHAR, in_Birthday DATE, in_CityCode INTEGER, in_Email VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS
$$
  BEGIN
    UPDATE DemoUsers SET
    Name = :in_Name,
    Birthday= :in_Birthday,
    CityCode = :in_CityCode,
    Email = :in_Email
    WHERE ID = :in_id;
-- ** MSC-ERROR - MSCEWI3111 - COMMIT STATEMENT REQUIRES ADDITIONAL INTERVENTION **
--    COMMIT
          ;
  END;
$$;

CALL PUBLIC.UpdateDemoUsers(5, 'TestUpdate', '2020-12-12', 840, 'testInsert@email.com');